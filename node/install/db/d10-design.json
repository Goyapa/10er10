[{"_id":"_design/album","views":{"name":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.album.length > 0 \n       && doc.valid\n       && doc.reviewed ) {\n    if ( doc.tracknumber ) {\n      emit ([doc.album,doc.tracknumber], null);\n    } else {\n      emit ([doc.album,0], null);\n    }\n  }\n}","reduce":"_count"},"search":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.album.length > 0 \n       && doc.valid\n       && doc.reviewed ) {\n \n    var nochar=new RegExp(\"[\\.,_?!\\\\[\\\\]\\\\{\\\\}\\\\(\\\\)]\",\"g\");\n    var reg=new RegExp(\" \", \"g\");\n    var tab=doc.album.replace(nochar,'').split(reg);\n    for ( var index in tab ) {\n      if ( tab[index].length > 2 ) {\n         emit ( [tab[index],doc.album], null);\n      }\n    }\n    emit ( [ doc.album, doc.album ], null );\n  }\n}"},"album":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.album.length > 0 \n       && doc.valid\n       && doc.reviewed ) {\n\n      emit (doc.album, null);\n\n  }\n}","reduce":"_count"}},"lists":{"search":"function (head, ctx) {\n var back = {\"albums\": []};\n var row;\n \n\twhile (row = getRow() ) {\n\t\tif ( row.key ) {\n\t\t      var key = row.key.pop();\n\t\t      if ( back.albums.indexOf(key) < 0 ) {\n\t\t        \n  \t\t      back.albums.push(key);\n  \t\t    }\n  }\n\t}\n back.albums.sort();\n\treturn JSON.stringify(back);\n}"},"language":"javascript"},{"_id":"_design/artist","language":"javascript","views":{"name":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.artist.length > 0 \n       && doc.valid\n       && doc.reviewed ) {\n    emit ([doc.artist,doc.title], null);\n  }\n}","reduce":"_count"},"search":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.artist.length > 0 \n       && doc.valid\n       && doc.reviewed ) {\n \n    var nochar=new RegExp(\"[\\.,_?!\\\\[\\\\]\\\\{\\\\}\\\\(\\\\)]\",\"g\");\n    var reg=new RegExp(\" \", \"g\");\n    var tab=doc.artist.replace(nochar,'').split(reg);\n    for ( var index in tab ) {\n      if ( tab[index].length > 2 ) {\n         emit ( [tab[index],doc.artist], null);\n      }\n    }\n    emit ( [doc.artist,doc.artist], null);\n  } \n}"},"artist":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.valid\n       && doc.reviewed ) {\n\n      emit (doc.artist, null);\n\n  }\n}","reduce":"_count"}},"lists":{"search":"function (head, ctx) {\n var back = {\"artists\": []};\n var row;\n \n\twhile (row = getRow() ) {\n\t\tif ( row.key ) {\n\t\t      var key = row.key.pop();\n\t\t      if ( back.artists.indexOf(key) < 0 ) {\n\t\t        \n  \t\t      back.artists.push(key);\n  \t\t    }\n  }\n\t}\n back.artists.sort();\n\treturn JSON.stringify(back);\n}"}},{"_id":"_design/genre","language":"javascript","views":{"name":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.genre.length > 0 \n       && doc.valid\n       && doc.reviewed ) {\n    emit ([doc.genre,doc.title], null);\n  }\n}","reduce":"_count"},"unsorted":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.genre.length > 0 \n       && doc.valid\n       && doc.reviewed ) {\n    emit (doc.genre, null);\n  }\n}"},"artist":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.genre.length > 0 \n       && doc.valid\n       && doc.reviewed ) {\n    emit ([doc.genre,doc.artist], null);\n  }\n}","reduce":"function (keys,values,rereduce) {\n\tvar maxlen=5;\n\t// { \"genre\": {\"count\": .. , \"artists\": [ \"artist\",\"artist\",\"artist\"] }\n\tif ( !rereduce ) {\n\t\tvar back = { count: 0, artists: [] };\n\t\tfor ( var k in keys ) {\n\t\t\tvar genre = keys[k][0][0];\n\t\t\tvar artist = keys[k][0][1];\n\t\t\tback.count ++;\n\t\t\tif ( back.artists.length < maxlen && back.artists.indexOf(artist) < 0 ) {\n\t\t\t\tback.artists.push(artist);\n\t\t\t}\n\t\t}\n\t\treturn back;\n\t}\n\tvar back = values.pop();\n\tfor ( var v in values ) {\n\t\tback.count += values[v].count;\n\t\tfor ( var a in values[v].artists ) {\n\t\t\tif ( back.artists.count < maxlen && back.artists.indexOf(values[v].artists[a]) < 0 ) {\n\t\t\t\tback.artists.push(values[v].artists[a]);\n\t\t\t}\n\t\t}\n\t}\n\treturn back;\n}"}}},{"_id":"_design/images","language":"javascript","views":{"sha1":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.valid\n       && doc.reviewed && doc.images && doc.images.length ) {\n\n\tdoc.images.forEach(function(img) {\n\t\temit (img.sha1, img.filename);\n\t});\n\n\n\n  }\n}"},"filename":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.valid\n       && doc.reviewed && doc.images && doc.images.length ) {\n\n\tdoc.images.forEach(function(img) {\n\t\temit (img.filename,null);\n\t});\n\n\n\n  }\n}"}}},{"_id":"_design/pagination","lists":{"mapping":"function (head, ctx) {\n var back = {\"id\": [], \"key\": [], \"count\": 0};\n// var dbg = [];\n\tvar row ;\n\tvar rpp = ctx.query.rpp ? ctx.query.rpp : 20;\n\tvar i = 1;\n\twhile (row = getRow() ) {\n \t//dbg.push ( {\"i\": i, \"doc\": row.id} );\n\t\tif ( i == 1 ) {\n\t\t  back.id.push ( row.id  ) ;\n\t\t  back.key.push ( row.key ) ;\n\t\t} else if ( i == rpp ) {\n\t\t  i=0;\n\t\t}\n\t\ti++;back.count++;\n\t}\n\treturn JSON.stringify({\"pages\":back});\n}"}},{"_id":"_design/s_user","language":"javascript","views":{"name":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.valid\n       && doc.reviewed ) {\n    emit ([doc.user, doc.title], null);\n  }\n}"}}},{"_id":"_design/song","language":"javascript","views":{"artist":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.artist.length > 0 \n       && doc.valid && doc.reviewed ) {\n    emit (doc.artist, 1);\n  }\n}","reduce":"function (key, values, rereduce) {\n    return sum(values);\n}\n"},"search":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n        && doc.valid && doc.valid == true && doc.reviewed == true ) {\n     var nochar=new RegExp(\"[\\.,_?!\\\\[\\\\]\\\\{\\\\}\\\\(\\\\)]\",\"g\");\n     var reg=new RegExp(\" \", \"g\");\n     var tab=doc.title\n              .replace(nochar,'').split(reg);\n     for ( var index in tab ) {\n        if ( tab[index].length > 2 ) {\n           emit ( tab[index], {\n             'text': doc.title+' (by '+doc.artist+')',\n             'json': { 'field': 'title', 'value': doc.title }\n           });\n        }\n     }\n     emit ( doc.title, {\n        'text': doc.title+' (by '+doc.artist+')',\n        'json': { 'field': 'title', 'value': doc.title }\n        });\n     \n     var tab=doc.artist\n              .replace(nochar,'').split(reg);\n     for ( var index in tab ) {\n        if ( tab[index].length > 2 ) {\n           emit ( tab[index], {\n             'text': 'artist: '+doc.artist,\n             'json': { 'field': 'artist', 'value': doc.artist }\n           });\n        }\n     }\n\n           emit ( doc.artist, {\n             'text': 'artist: '+doc.artist,\n             'json': { 'field': 'artist', 'value': doc.artist }\n           });\n\n\n     if ( doc.album && doc.album.length ) {\n           emit ( doc.album, {\n               'text': 'album: '+doc.album+' (by '+doc.artist+')',\n               'json': { 'field': 'album', 'value': doc.album }\n            });\n\n      var tab=doc.album\n              .replace(nochar,'').split(reg);\n      for ( var index in tab ) {\n         if ( tab[index].length > 2 ) {\n            emit ( tab[index], {\n               'text': 'album: '+doc.album+' (by '+doc.artist+')',\n               'json': { 'field': 'album', 'value': doc.album }\n            });\n         }\n      }\n     }\n  }\n}"},"title":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.title.length > 0 \n       && doc.valid && doc.reviewed ) {\n    emit (doc.title, null);\n  }\n}","reduce":"_count"},"sha1":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.sha1 ) {\n    emit (doc.sha1, null);\n  }\n}"},"length":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.duration \n       && doc.valid && doc.reviewed ) {\n    emit (doc._id, doc.duration);\n  }\n}","reduce":"_sum"}}},{"_id":"_design/title","views":{"name":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.title.length > 0 \n       && doc.valid\n       && doc.reviewed ) {\n    emit ([doc.title,doc.artist], null);\n  }\n}","reduce":"_count"},"search":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.valid\n       && doc.reviewed ) {\n \n    var nochar=new RegExp(\"[\\.,_?!\\\\[\\\\]\\\\{\\\\}\\\\(\\\\)]\",\"g\");\n    var reg=new RegExp(\" \", \"g\");\n    var tab=doc.title\n              .replace(nochar,'').split(reg);\n    for ( var index in tab ) {\n      if ( tab[index].length > 2 ) {\n         emit ( [tab[index],doc.title], null);\n      }\n    }\n  } \n}"}},"lists":{"search":"function (head, ctx) {\n var back = {\"titles\": []};\n var row;\n var lastKey = \"\";\n\twhile (row = getRow() ) {\n\t\tif ( row.key ) {\n\t\t      var key = row.key.pop();\n\t\t      if ( lastKey != key ) {\n\t\t        lastKey = key;\n  \t\t      back.titles.push(key);\n  \t\t    }\n  }\n\t}\n back.titles.sort();\n\treturn JSON.stringify(back);\n}"},"language":"javascript"},{"_id":"_design/ts_creation","views":{"name":{"map":"function (doc) {\n  if ( doc._id.substring(0,2) == 'aa' \n       && doc.valid\n       && doc.reviewed ) {\n    emit ([doc.ts_creation,doc.title], null);\n  }\n}","reduce":"_count"}}},{"_id":"_design/user","language":"javascript","views":{"song":{"map":"function(doc) {\n  if ( doc._id.substring(0,2) == 'aa' ) {\n    emit([doc.user,doc.reviewed] ,null);\n  }\n}"},"all_infos":{"map":"function(doc) {\n  if ( doc._id.substring(0,2) == 'us' ) {\n    emit([ doc._id.substr(2) ,'us'] ,null);\n  } else if ( doc._id.substring(0,2) == 'pr' ) {\n    emit([ doc._id.substr(2) ,'pr'] ,null);\n  } else if ( doc._id.substring(0,2) == 'up' ) {\n    emit([ doc._id.substr(2) ,'up'] ,null);\n  } else if ( doc._id.substring(0,2) == 'pl' ) {\n    emit([ doc.user.substr(2) ,'pl'] ,null);\n  } else if ( doc._id.substring(0,2) == 'se' ) {\n    emit([ doc.user.substr(2) ,'se'] ,null);\n  }\n}"}}}]